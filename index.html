<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generative Focus Soundscape</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Barlow:wght@300;400&family=Inter:wght@400;600;700&family=Oswald:wght@400&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 1rem;
            text-align: center;
        }
        #main-header {
            font-family: 'Oswald', sans-serif;
            text-transform: uppercase;
            color: #000000;
        }
        .body-text {
            font-family: 'Barlow', sans-serif;
            font-weight: 300;
        }
        .button-font {
            font-family: 'Barlow', sans-serif;
            font-weight: 300;
            font-size: 14px;
            text-transform: uppercase;
        }
        .sound-button-font {
            font-family: 'Barlow', sans-serif;
            font-weight: 400;
            text-transform: uppercase;
        }
        .bg-custom-pink {
            background-color: #e91d63;
        }
        .hover-bg-custom-pink-darker:hover {
            background-color: #c41a52;
        }
        .text-custom-pink {
            color: #e91d63;
        }
        .hover-bg-custom-pink-light:hover {
            background-color: #f7e0e7;
        }
        .message-box {
            position: fixed;
            top: 2rem;
            left: 50%;
            transform: translateX(-50%);
            background-color: #3b82f6;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            display: none;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }
        .sound-toggle-btn:disabled, .sound-toggle-btn[disabled] {
            cursor: not-allowed;
            opacity: 0.6;
            pointer-events: none;
        }
    </style>
</head>
<body class="bg-slate-100 text-slate-800">

<div class="container">
    <div class="max-w-xl w-full p-8 md:p-12 bg-white rounded-xl shadow-2xl space-y-8">
        <h1 id="main-header" class="text-xl sm:text-2xl font-bold">Generative Focus Soundscape</h1>
        <p class="body-text text-base md:text-lg text-slate-600 leading-relaxed">
            This module generates sounds in real-time. Click "Start Sound" and then mix and match the layers to create your ideal soundscape.
        </p>

        <div class="flex flex-col sm:flex-row items-center justify-center gap-4">
            <button id="start-button" class="button-font bg-custom-pink hover-bg-custom-pink-darker text-white font-semibold py-3 px-8 rounded-xl shadow-lg transition-all duration-300 transform hover:scale-105 active:scale-95">
                Start Sound
            </button>
            <button id="stop-all-button" class="button-font bg-white text-custom-pink hover-bg-custom-pink-light font-semibold py-3 px-8 rounded-xl shadow-lg transition-all duration-300 transform hover:scale-105 active:scale-95" disabled>
                Stop All
            </button>
        </div>

        <div id="sound-buttons" class="grid grid-cols-2 md:grid-cols-3 gap-4 pt-4">
            <button data-sound="rain" class="sound-toggle-btn sound-button-font bg-slate-200 text-slate-800 py-3 px-6 rounded-xl shadow-md transition-all duration-300 active:scale-95 hover:bg-slate-300" disabled>
                Rain
            </button>
            <button data-sound="forest" class="sound-toggle-btn sound-button-font bg-slate-200 text-slate-800 py-3 px-6 rounded-xl shadow-md transition-all duration-300 active:scale-95 hover:bg-slate-300" disabled>
                Forest
            </button>
            <button data-sound="coffeeshop" class="sound-toggle-btn sound-button-font bg-slate-200 text-slate-800 py-3 px-6 rounded-xl shadow-md transition-all duration-300 active:scale-95 hover:bg-slate-300" disabled>
                Coffee Shop
            </button>
            <button data-sound="music" class="sound-toggle-btn sound-button-font bg-slate-200 text-slate-800 py-3 px-6 rounded-xl shadow-md transition-all duration-300 active:scale-95 hover:bg-slate-300" disabled>
                Calm Music
            </button>
            <button data-sound="stream" class="sound-toggle-btn sound-button-font bg-slate-200 text-slate-800 py-3 px-6 rounded-xl shadow-md transition-all duration-300 active:scale-95 hover:bg-slate-300" disabled>
                Gentle Stream
            </button>
            <button data-sound="ocean" class="sound-toggle-btn sound-button-font bg-slate-200 text-slate-800 py-3 px-6 rounded-xl shadow-md transition-all duration-300 active:scale-95 hover:bg-slate-300" disabled>
                Ocean Waves
            </button>
        </div>
    </div>
</div>

<div id="message-box" class="message-box"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const showMessage = (text) => {
            const msgBox = document.getElementById('message-box');
            msgBox.textContent = text;
            msgBox.style.display = 'block';
            setTimeout(() => {
                msgBox.style.opacity = 1;
            }, 10);
            setTimeout(() => {
                msgBox.style.opacity = 0;
                setTimeout(() => msgBox.style.display = 'none', 300);
            }, 2000);
        };

        const toggleButtonState = (button, isActive) => {
            if (isActive) {
                button.classList.remove('bg-slate-200', 'text-slate-800', 'hover:bg-slate-300');
                button.classList.add('bg-blue-500', 'text-white', 'hover:bg-blue-600');
            } else {
                button.classList.remove('bg-blue-500', 'text-white', 'hover:bg-blue-600');
                button.classList.add('bg-slate-200', 'text-slate-800', 'hover:bg-slate-300');
            }
        };

        let isAudioReady = false;
        const sounds = {};
        const soundUrls = {
            'coffeeshop': 'https://morajennifer808-commits.github.io/soundscape-project/audio/coffeeshop.mp3',
            'forest': 'https://morajennifer808-commits.github.io/soundscape-project/audio/forest.mp3',
            'ocean': 'https://morajennifer808-commits.github.io/soundscape-project/audio/ocean.mp3',
            'rain': 'https://morajennifer808-commits.github.io/soundscape-project/audio/rain.mp3',
            'stream': 'https://morajennifer808-commits.github.io/soundscape-project/audio/stream.mp3',
            'music': 'https://morajennifer808-commits.github.io/soundscape-project/audio/music.mp3'
        };

        const startButton = document.getElementById('start-button');
        const stopAllButton = document.getElementById('stop-all-button');
        const soundButtons = document.querySelectorAll('.sound-toggle-btn');
        
        const loadSounds = () => {
            return new Promise(resolve => {
                const players = {};
                const promises = [];
                for (const soundName in soundUrls) {
                    const player = new Tone.Player(soundUrls[soundName]).toDestination();
                    player.loop = true;
                    player.autostart = false;
                    players[soundName] = player;
                    promises.push(player.load());
                }
                Promise.all(promises).then(() => {
                    resolve(players);
                });
            });
        };

        startButton.addEventListener('click', async () => {
            if (!isAudioReady) {
                startButton.textContent = 'Loading...';
                startButton.disabled = true;

                await Tone.start();
                
                const players = await loadSounds();
                Object.assign(sounds, players);

                isAudioReady = true;
                startButton.style.display = 'none';
                stopAllButton.disabled = false;
                
                soundButtons.forEach(btn => {
                    btn.disabled = false;
                });
                
                showMessage('Audio is now active. Mix and match the sounds!');
            }
        });

        stopAllButton.addEventListener('click', () => {
            if (isAudioReady) {
                for (const soundName in sounds) {
                    if (sounds[soundName].state === 'started') {
                        sounds[soundName].stop();
                    }
                }
                soundButtons.forEach(btn => {
                    toggleButtonState(btn, false);
                });
                showMessage('All sounds stopped.');
            }
        });

        soundButtons.forEach(button => {
            button.addEventListener('click', () => {
                const soundName = button.dataset.sound;
                const sound = sounds[soundName];

                if (!isAudioReady) {
                    showMessage('Please click "Start Sound" first.');
                    return;
                }

                if (sound && sound.state === 'started') {
                    sound.stop();
                    toggleButtonState(button, false);
                    showMessage(`${button.textContent} deactivated.`);
                } else if (sound) {
                    sound.start();
                    toggleButtonState(button, true);
                    showMessage(`${button.textContent} activated.`);
                }
            });
        });
    });
</script>
</body>
</html>
